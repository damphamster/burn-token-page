<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burn Tokens</title>
    <!-- Load libraries -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@solana/spl-token@0.3.8/lib/index.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bs58@5.0.0/dist/index.min.js"></script>
</head>
<body>
    <div style="text-align: center; padding: 20px;">
        <h1>Burn 100,000 Tokens</h1>
        <button onclick="handleBurnClick()" style="padding: 10px 20px; font-size: 16px;">
            Create Burn Transaction
        </button>
        <p id="status" style="margin-top: 20px;"></p>
    </div>

    <script>
        const TOKEN_MINT = '4FpDZyrVbt5XFyzVENnKB8nPRBGe4QMmom8ufdJVpump';
        const AMOUNT_TO_BURN = 100000 * Math.pow(10, 6); // 100,000 tokens with 6 decimals
        const TOKEN_PROGRAM_ID = 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA';

        function updateStatus(message) {
            document.getElementById('status').innerText = message;
            console.log(message);
        }

        async function handleBurnClick() {
            try {
                updateStatus('Creating transaction...');
                
                // Connect to Solana
                const connection = new solanaWeb3.Connection(
                    solanaWeb3.clusterApiUrl('mainnet-beta'),
                    'confirmed'
                );

                // Create a dummy keypair for transaction building
                const dummyKey = solanaWeb3.Keypair.generate();

                // Get the token account address
                const tokenAccount = await SplToken.getAssociatedTokenAddress(
                    new solanaWeb3.PublicKey(TOKEN_MINT),
                    dummyKey.publicKey,
                    false,
                    new solanaWeb3.PublicKey(TOKEN_PROGRAM_ID)
                );

                updateStatus('Creating burn instruction...');

                // Create burn instruction
                const burnInstruction = SplToken.createBurnInstruction(
                    tokenAccount,
                    new solanaWeb3.PublicKey(TOKEN_MINT),
                    dummyKey.publicKey,
                    AMOUNT_TO_BURN,
                    [],
                    new solanaWeb3.PublicKey(TOKEN_PROGRAM_ID)
                );

                // Create transaction and add the burn instruction
                const transaction = new solanaWeb3.Transaction().add(burnInstruction);
                
                updateStatus('Getting recent blockhash...');
                
                // Get recent blockhash
                const { blockhash } = await connection.getLatestBlockhash('finalized');
                transaction.recentBlockhash = blockhash;
                transaction.feePayer = dummyKey.publicKey;

                // Serialize the transaction
                const serializedTransaction = transaction.serialize({
                    requireAllSignatures: false
                }).toString('base64');

                updateStatus('Creating Phantom URL...');

                // Create Phantom transaction request URL
                const phantomURL = `https://phantom.app/ul/v1/request-transaction` +
                    `?dapp_encryption_public_key=${bs58.encode(dummyKey.publicKey.toBytes())}` +
                    `&transaction=${encodeURIComponent(serializedTransaction)}` +
                    `&redirect_link=${encodeURIComponent(window.location.href)}` +
                    `&network=mainnet-beta`;

                updateStatus('Opening Phantom wallet...');
                console.log('Transaction URL:', phantomURL);

                // Open transaction in Phantom
                window.location.href = phantomURL;

            } catch (error) {
                console.error('Error:', error);
                updateStatus('Error: ' + error.message);
            }
        }
    </script>
</body>
</html>